<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyundai.dutyfree.mapper.OrderMapper">
	<insert id="insertPassport" >
		insert into Passport values
		(#{mid},#{passportno},#{surname},#{givenname},
		#{pgender},#{pbirth},#{expirydate},#{nationality})
		
	</insert>
	
	<select id="PassportConsist" resultType="com.hyundai.dutyfree.vo.PassportVO">
	select * from passport where mid=#{mid} 
	</select>
	
	<insert id="Insertorderitem">
	insert into orderitem values(#{pcode},#{oamount},#{oid})
	</insert>
	
	<insert id="Insertorderlist">
	insert into orderlist values(#{oid},#{mid},to_date(sysdate,'YYYY-MM-DD HH24:MI'),#{ohpoint},#{ostatus},to_date(#{oarrdate},'YYYY-MM-DD HH24:MI'),#{oplnum},#{oelnum},#{oplace})
	</insert>
	
	<select id="getorderlist">
	select * from orderlist where oid=#{oid};
	</select>
	
	<update id="updateTotalandMhpoint">
	update member set mhpoint=#{mhpoint},mtotal=#{mtotal} where mid=#{mid}
	</update>
	
	<select id="getOrderitemlist" resultType="com.hyundai.dutyfree.vo.OrderItemVO">
	select o.oid, o.pcode from member m join
	(select ol.oid, ol.mid, oi.pcode from orderitem oi join orderlist ol on oi.oid=ol.oid) o
	on m.mid = o.mid
	where m.mid =#{mid}
	</select>
	
</mapper>
  